# Circuit Designer - ユーザーマニュアル

このツールは、電子工作や基板設計のための配線図を、ブラウザ上で直感的に作成・管理するためのツールです。
標準的なICからストリップボード（ユニバーサル基板）、カスタムモジュールまで幅広く対応しています。

---

## 1. 基本操作

### キャンパス操作
- 拡大・縮小: マウスホイール
- 視点移動: 基板外のエリアをドラッグ
- パーツの移動: 配置済みのパーツをドラッグ
- ワイヤの描画: 基板の穴、またはパーツのピンをドラッグして別の穴まで繋ぐ

### ボード設定 (Board Settings)
- Width / Height: 基板のグリッドサイズを指定します。「Update Board」で反映されます。

---

## 2. コンポーネントの設定 (Component Settings)

パーツを追加・編集する際の各設定項目の詳細です。

### 基本プロパティ
- Label: パーツ上に表示される名前です（例: IC1, ESP32）。
- Width / Height: グリッド単位でのサイズです。
- Pins (Top/Right & Bottom/Left): 
    - カンマ区切りでピン名を入力します（例: `VCC,GND,RX,TX`）。
    - 縦向きの場合は「右側・左側」、横向きの場合は「上側・下側」に配置されます。
    - Pin Presets: 下部にあるボタン（GND, VCC, GPIO等）をクリックすることで、選択中の入力欄に素早くピン名を追加できます。
    - ⇅ Swap: 上下のピンリストを入れ替えます。

### 特殊レンダリング設定 (Config)
- Relative (相対レイアウト):
    - ピン名がパーツの体全体に広がり、視認性が向上します。
- Rotate (回転):
    - パーツを90度回転させて配置します。
- Board (基板モード):
    - 重要: これをONにすると、そのパーツは「背景用の基板」として扱われます。
    - ピン（ソケット）は描画されず、メイン基板と同じ「穴」が開いたサブ基板として表示されます。
    - 他のパーツやワイヤよりも下の階層に描画されるため、モジュール基板の土台として最適です。
    - ONにするとピン入力が無効化されます。

---

## 3. ライブラリエディタ (Component Library)

よく使うパーツをテンプレートとして保存し、いつでも呼び出せるようにします。

- Edit: ライブラリエディタを開きます。
- Config列: 各パーツの `Rel(相対)`, `Rot(回転)`, `Brd(基板)` の設定状況が一目で確認できます。
- Add New / Update: 現在入力されている内容をテンプレートとして追加・更新します。
- Delete: 選択中のテンプレートを削除します。
- Import to Board: ライブラリ内のすべてのパーツを一度にメイン基板に配置します（並びは自動調整されます）。
- Export (Library Editor内): 編集中のライブラリを `edited_components<日時>.json` として保存します。
- Import / Export (メインメニュー): 基板上のパーツをライブラリ形式で入出力します。エクスポート時は `current_components<日時>.json` となります。
- Save / Load Library: ライブラリデータ（JSON）をファイルとして保存・読み込みします。

---

## 4. プロジェクトの保存と管理

### データ管理
- Save: 現在の基板の状態（パーツ配置、すべての配線）を `current_state<日時>.json` として保存します。
- Load: 保存したJSONファイルを読み込み、作業を再開します。
- Clear All: すべてのパーツと配線を削除してリセットします。

### 画像出力 (Image Export)
- Export Display Area: 現在画面に見えている範囲を画像 `Circuit_picture<日時>.png` として出力します。
- Export Board Area: 基板とパーツが存在する全範囲を自動で計算し、ちょうど収まるサイズで画像出力します。
  ※出力ファイル名には実行時の日時（YYYYMMDDhhmmss）が自動的に付与されます。

---

## 5. 配線 (Wire Settings)

- Front (表配線): パーツと同じ面に配線します（実線）。
- Back (裏配線): 基板の裏面に配線します（点線）。
- Color: パレットから好きな色を選択して配線できます。配線済みのワイヤをクリックして選択し、Deleteキーで削除可能です。

---

## 6. ショートカットキー
- Delete / Backspace: 選択中のパーツまたはワイヤを削除します。
- Ctrl + Z: 元に戻す（Undo）
- Ctrl + Y: やり直し（Redo）
