# 配線図作成ツール 実装計画 (Implementation Plan)

## プロジェクト目標
基盤（ユニバーサル基板）の穴の数を指定して新しいファイルを作成し、センサーの大きさ、配線の色等を指定して配線図を作成できるソフトウェアを開発する。

## ユーザー確認事項 (User Review Required)
以下の点について方針を確認させてください。
> [!IMPORTANT]
> **1. プラットフォーム**
> ブラウザで動作するWebアプリケーション（HTML/CSS/JavaScript）として作成します。特別なインストールが不要で、環境を選ばずに動作するため推奨します。
>
> **2. データの保存方法**
> 作成した配線図は、**JSONファイル**として保存し、後で読み込んで再編集できるようにします。また、画像（PNG）としての書き出し機能も実装します。
>
> **3. 基盤の仕様**
> 一般的なユニバーサル基板（2.54mmピッチのグリッド穴）をシミュレートした画面とします。「穴の数（横・縦）」を指定してサイズを決定します。
>
> **4. 部品の配置方法**
> 特定の製品名リストから選ぶのではなく、都度「幅（穴数）・高さ（穴数）」を指定して、汎用的な四角形の部品として配置する形式を基本とします。

## 提案する変更内容 (Proposed Changes)
モダンで美しいWebインターフェース（HTML/CSS/JS）を作成します。

### インターフェース設計 (UI Design)
- **メインキャンバス**: 
  - メインのユニバーサル基板グリッド。
  - **基盤外エリア**: 基盤の周囲に十分な余白を設け、マイコンなどの外部モジュールを配置可能にする [New]。
- **サイドバー/コントロールパネル**:
  - **新規作成**: 基盤の穴数（幅 x 高さ）指定フィールド。
  - **配線設定**: 
    - **色選択**: 標準10色 + 錫メッキ線。
    - **配線タイプ**: 表/裏切り替え。
  - **部品設定**: 
    - 幅・高さ指定。
    - **部品名（ラベル）入力**。
    - **ピン名（ソケット名）入力**: カンマ区切りで指定（例: "VCC,GND,D1,D2..."） [New]。
    - 「配置」ボタン。
    - **「更新」ボタン**: 選択中の部品の情報を更新 [New]。
  - **保存・出力**: JSON保存ボタン、画像書き出しボタン。

### 技術スタック
- **HTML5**: セマンティックなマークアップ。
- **CSS3**: 変数を使用したモダンなスタイリング。
- **JavaScript (Vanilla)**: 
  - キャンバスサイズを基盤サイズ+余白に拡張。
  - `drawComponent`を更新し、**ピンごとのラベル描画**に対応 [New]。
  - 部品のドラッグ制限を緩和し、**基盤外への配置**を許可 [New]。
  - **Undo/Redo機能**: 
  - **Undo/Redo機能**: 
    - 履歴スタックを用いた状態管理 (Ctrl+Z, Ctrl+Y)。
    - **注**: テキスト入力（ラベル編集など）は対象外。
    - **修正**: 配線追加時のUndo動作を確実に保証する。
  - **部品・配線選択・編集機能**: 
    - クリックで部品または**配線**を選択可能にする [New]。
    - 選択状態で `Delete` または `Backspace` キーで削除可能にする [New]。
    - サイドバーに情報を反映・更新。

### ファイル構成
```
/wiring_diagram
  /index.html      (メインUI)
  /css/style.css   (スタイル定義)
  /js/app.js       (アプリケーションロジック)
  /js/canvas.js    (描画処理)
```

## 検証計画 (Verification Plan)

### 自動テスト (Automated Tests)
- 基本的にUIインタラクションが中心のため、手動テストを主とします。

### 手動テスト (Manual Verification)
1. **基盤生成テスト**
   - 異なる穴数（例: 20x10, 50x50）を入力し、正しくグリッドが生成されるか確認。
2. **配線描画テスト**
   - マウスドラッグで配線が引けるか。
   - 色を変更して、異なる色の線が引けるか確認。
3. **部品配置テスト**
   - 指定したサイズ（例: 4x4穴）の部品がキャンバス上に配置できるか確認。
4. **保存・読み込みテスト**
   - JSONファイルとしてダウンロードできるか。
   - そのファイルを再度読み込み、元の状態が復元されるか確認。
